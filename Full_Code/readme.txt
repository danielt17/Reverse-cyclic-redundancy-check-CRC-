This is an old version contating all of the code in one file.
